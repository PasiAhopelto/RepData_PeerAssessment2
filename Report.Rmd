---
title: "Basic Statistical Analysis of Severe Weather Events in the United States"
output: 
  html_document:
    keep_md: true
---

## Synopsis

This study uses NOAA Storm Database's data to find out what types events are most harmful to population's health and the types that cause most economical damage across the United States.  

## Data Processing

Data was downloaded from https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2 at 2015-03-12 and uncompressed with bzip2.

Analysis is carried out with R's data.table and ggplot libraries.

```{r}
library(data.table)
library(ggplot2)
```

To answer the first question about effect on populations health, the data is aggregated by event types by calculating sum, mean and median of fatalities and injuries.
```{r cache=TRUE}
csv <- read.csv(file = 'repdata_data_StormData.csv')
fatalitiesAndInjuriesSumByEventType <- aggregate(. ~ EVTYPE, data=csv[,c('EVTYPE', 'FATALITIES', 'INJURIES')], FUN=sum)
fatalitiesAndInjuriesMeanByEventType <- aggregate(. ~ EVTYPE, data=csv[,c('EVTYPE', 'FATALITIES', 'INJURIES')], FUN=mean)
fatalitiesAndInjuriesMedianByEventType <- aggregate(. ~ EVTYPE, data=csv[,c('EVTYPE', 'FATALITIES', 'INJURIES')], FUN=median)
```

Finally events without fatalities and injuries are filtered out to make reading the results simpler.
```{r cache=TRUE}
fatalitiesAndInjuriesSumByEventType <- fatalitiesAndInjuriesSumByEventType[
  fatalitiesAndInjuriesSumByEventType$FATALITIES > 0 | fatalitiesAndInjuriesSumByEventType$INJURIES > 0,] 
fatalitiesAndInjuriesMeanByEventType <- fatalitiesAndInjuriesMeanByEventType[
  fatalitiesAndInjuriesMeanByEventType$FATALITIES > 0 | fatalitiesAndInjuriesMeanByEventType$INJURIES > 0,] 
fatalitiesAndInjuriesMedianByEventType <- fatalitiesAndInjuriesMedianByEventType[
  fatalitiesAndInjuriesMedianByEventType$FATALITIES > 0 | fatalitiesAndInjuriesMedianByEventType$INJURIES > 0,] 
```

When investigating storms' economical impact, the same aggregation is carried over property and crop damage expenditures.

```{r cache=TRUE}
damagesSumByEventType <- aggregate(. ~ EVTYPE, data=csv[,c('EVTYPE', 'PROPDMGEXP', 'CROPDMGEXP')], FUN=sum)
damagesMeanByEventType <- aggregate(. ~ EVTYPE, data=csv[,c('EVTYPE', 'PROPDMGEXP', 'CROPDMGEXP')], FUN=mean)
damagesMedianByEventType <- aggregate(. ~ EVTYPE, data=csv[,c('EVTYPE', 'PROPDMGEXP', 'CROPDMGEXP')], FUN=median)
```

```{r cache=TRUE}
damagesSumByEventType <- damagesSumByEventType[
  damagesSumByEventType$PROPDMGEXP > 0 | damagesSumByEventType$CROPDMGEXP > 0,] 
damagesMeanByEventType <- damagesMeanByEventType[
  damagesMeanByEventType$PROPDMGEXP > 0 | damagesMeanByEventType$CROPDMGEXP > 0,] 
damagesMedianByEventType <- damagesMedianByEventType[
  damagesMedianByEventType$PROPDMGEXP > 0 | damagesMedianByEventType$CROPDMGEXP > 0,] 
```

## Results